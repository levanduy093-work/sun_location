--- Page 1 ---
 Solar	Mirror	Optimizer	-	Technical	Specification	for	AI	Agent Project	Overview Project	Name:	Solar	Mirror	Optimizer	with	Real-time	Sun	Position	Visualization Primary	Goal:	Build	a	web-based	visualization	tool	that	displays	the	sun's	position	throughout	the	day	with	a	2D	animation	showing	a	house	at	the	center	and	the	sun	moving	along	its	arc	path.	The	system	will	calculate	precise	solar	angles	to	later	optimize	mirror	positioning	for	a	solar	panel	booster	system. Target	User:	Electrical	engineering	student	working	on	solar	energy	optimization	project	in	Ho	Chi	Minh	City,	Vietnam. Platform:	Desktop	application	running	on	macOS	(M3	MacBook),	web-based	interface	accessed	via	browser. System	Architecture Technology	Stack Backend: ‚Ä¢ Language:	Python	3.9+ ‚Ä¢ Framework:	Flask	(lightweight	web	server) ‚Ä¢ Solar	calculations:	pvlib-python	library ‚Ä¢ Time	handling:	pandas,	pytz ‚Ä¢ Math	operations:	numpy Frontend: ‚Ä¢ HTML5	Canvas	for	2D	graphics ‚Ä¢ Vanilla	JavaScript	(no	frameworks) ‚Ä¢ CSS3	for	styling ‚Ä¢ No	external	JavaScript	libraries	initially	(pure	implementation) 
--- Page 2 ---
Development	Environment: ‚Ä¢ macOS	with	Python	3.9+ ‚Ä¢ Modern	web	browser	(Chrome/Safari) ‚Ä¢ Text	editor	or	IDE	(VS	Code	recommended) Project	Structure solar-mirror-optimizer/ ‚îÇ ‚îú‚îÄ‚îÄ backend/ ‚îÇ   ‚îú‚îÄ‚îÄ app.py                    # Flask application entry point ‚îÇ   ‚îú‚îÄ‚îÄ solar_calculator.py       # Core solar position calculations ‚îÇ   ‚îú‚îÄ‚îÄ config.py                 # Configuration (location, timezone) ‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt          # Python dependencies ‚îÇ ‚îú‚îÄ‚îÄ frontend/ ‚îÇ   ‚îú‚îÄ‚îÄ index.html                # Main HTML page ‚îÇ   ‚îú‚îÄ‚îÄ css/ ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ style.css            # All styling ‚îÇ   ‚îú‚îÄ‚îÄ js/ ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ canvas.js            # Canvas drawing functions ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ animation.js         # Animation loop and controls ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.js               # Backend API communication ‚îÇ   ‚îî‚îÄ‚îÄ assets/ ‚îÇ       ‚îî‚îÄ‚îÄ (icons will be simple shapes, no images initially) ‚îÇ ‚îú‚îÄ‚îÄ tests/ ‚îÇ   ‚îî‚îÄ‚îÄ test_solar_calculator.py  # Unit tests for accuracy ‚îÇ ‚îî‚îÄ‚îÄ README.md                     # Setup instructions  Functional	Requirements Core	Features	(MVP	-	Minimum	Viable	Product) 1. Solar	Position	Calculation 
--- Page 3 ---
o Calculate	sun	elevation	angle	(degrees	above	horizon) o Calculate	sun	azimuth	angle	(degrees	from	North,	clockwise) o Use	pvlib-python	SPA	algorithm	for	¬±0.01¬∞	accuracy o Location:	Ho	Chi	Minh	City	(10.8231¬∞N,	106.6297¬∞E,	altitude	19m) o Timezone:	Asia/Ho_Chi_Minh	(UTC+7) 2. 2D	Canvas	Visualization o Canvas	size:	800x600	pixels	(responsive	later) o Center	point:	House	icon	at	(400,	400) o Sun	path:	Semi-circular	arc	from	East	(90¬∞)	to	West	(270¬∞) o Arc	radius:	250	pixels	from	center o Background:	Light	blue	for	day,	dark	blue	for	night 3. Visual	Elements o House:	Simple	rectangle	or	triangle	at	center	(50x50px) o Sun:	Yellow	circle	(diameter	30px)	moving	along	arc o Sun	path:	Dashed	arc	line	showing	full	trajectory o Cardinal	directions:	N,	E,	S,	W	labels	at	edges o Grid	lines:	Optional	compass	lines	every	45¬∞ 4. Information	Display o Current	time:	HH:MM:SS	format o Solar	elevation:	"Elevation:	XX.XX¬∞" o Solar	azimuth:	"Azimuth:	XXX.XX¬∞" o Sunrise	time:	"Sunrise:	HH:MM" o Sunset	time:	"Sunset:	HH:MM" o Current	date:	YYYY-MM-DD 5. Animation	Controls o Play/Pause	button o Time	slider	(00:00	to	23:59) 
--- Page 4 ---
o Speed	control:	1x,	10x,	60x,	300x	(real-time	to	5	min/sec) o Date	picker	(to	simulate	different	days) o Reset	button	(go	to	current	time) Backend	API	Endpoints Endpoint	1:	Get	Current	Sun	Position GET /api/sun-position Response: {   "timestamp": "2025-11-11T10:30:00+07:00",   "elevation": 45.23,   "azimuth": 135.67,   "zenith": 44.77,   "is_daytime": true }  Endpoint	2:	Get	Sun	Position	at	Specific	Time GET /api/sun-position?datetime=2025-11-11T14:00:00 Response: (same format as above)  Endpoint	3:	Get	Full	Day	Sun	Path GET /api/sun-path?date=2025-11-11&interval=60 Parameters:   - date: YYYY-MM-DD   - interval: minutes between data points (default 60) Response: {   "date": "2025-11-11",   "sunrise": "05:48",   "sunset": "17:29",   "solar_noon": "11:38",   "path": [     {"time": "06:00", "elevation": 5.2, "azimuth": 88.5},     {"time": "07:00", "elevation": 15.8, "azimuth": 95.2},     ... (24 data points for interval=60)   ] 
--- Page 5 ---
}  Endpoint	4:	Serve	Static	Files GET / ‚Üí index.html GET /css/* ‚Üí CSS files GET /js/* ‚Üí JavaScript files  Technical	Specifications Canvas	Coordinate	System Coordinate	Mapping: ‚Ä¢ Canvas	origin	(0,0)	=	top-left ‚Ä¢ House	center	=	(400,	400)	in	canvas	coordinates ‚Ä¢ Y-axis	inverted:	higher	Y	=	lower	on	screen Sun	Position	Calculation: Given: elevation (Œ±), azimuth (Œ≤)  Canvas coordinates: - x = centerX + radius * sin(azimuth_rad) * cos(elevation_rad) - y = centerY - radius * cos(azimuth_rad) * cos(elevation_rad)  Where: - centerX = 400 - centerY = 400 - radius = 250 - azimuth_rad = (azimuth - 90) * œÄ/180  (adjust for East=0) - elevation_rad = elevation * œÄ/180  Arc	Path	Drawing: ‚Ä¢ Start	angle:	0¬∞	(East,	right	side) ‚Ä¢ End	angle:	180¬∞	(West,	left	side) ‚Ä¢ Arc	is	only	drawn	above	horizon	(elevation	>	0) 
--- Page 6 ---
‚Ä¢ Use	dashed	line	style Animation	Implementation Animation	Loop: let currentTime = new Date(); let isPlaying = false; let speed = 1; // real-time multiplier  function animate() {   if (isPlaying) {     currentTime += (1000 * speed); // advance time     fetchSunPosition(currentTime);     drawVisualization();   }   requestAnimationFrame(animate); }  Frame	Rate: ‚Ä¢ Target:	30	FPS	minimum ‚Ä¢ Update	sun	position:	every	frame	if	animating,	or	on	user	input ‚Ä¢ API	calls:	throttled	to	max	1	per	second	during	animation Data	Flow 1. Initial	Load: o Frontend	loads	HTML/CSS/JS o JavaScript	calls	/api/sun-position	for	current	time o JavaScript	calls	/api/sun-path	for	full	day	data o Draw	initial	visualization 2. Animation	Loop: o Increment	internal	time	variable o Interpolate	sun	position	from	cached	path	data 
--- Page 7 ---
o Redraw	canvas	with	new	position o Update	text	displays 3. User	Interaction: o Slider	drag:	update	time,	pause	animation,	fetch	new	position o Play	button:	start	animation	loop o Date	picker:	fetch	new	day	data,	reset	animation Calculation	Details Solar	Position	Algorithm: ‚Ä¢ Use	pvlib.location.Location	class ‚Ä¢ Method:	spa_python()	for	highest	accuracy ‚Ä¢ Atmospheric	refraction:	included ‚Ä¢ Equation	of	time:	handled	by	pvlib Input	Parameters: latitude = 10.8231    # Ho Chi Minh City longitude = 106.6297 altitude = 19         # meters above sea level timezone = 'Asia/Ho_Chi_Minh'  Edge	Cases	to	Handle: ‚Ä¢ Sun	below	horizon	(elevation	<	0):	don't	draw	sun,	show	night	mode ‚Ä¢ Midnight:	handle	date	transition ‚Ä¢ Leap	years:	handled	by	datetime ‚Ä¢ DST:	Vietnam	doesn't	have	DST,	but	timezone	library	handles	it Visual	Design	Specifications Color	Scheme Day	Mode	(sun	elevation	>	0): 
--- Page 8 ---
‚Ä¢ Background:	#87CEEB	(sky	blue) ‚Ä¢ Ground:	#90EE90	(light	green) ‚Ä¢ House:	#8B4513	(brown) ‚Ä¢ Sun:	#FFD700	(gold)	with	#FFA500	(orange)	glow ‚Ä¢ Path	line:	#FFFFFF	(white)	dashed,	50%	opacity ‚Ä¢ Text:	#000000	(black) Night	Mode	(sun	elevation	‚â§	0): ‚Ä¢ Background:	#191970	(midnight	blue) ‚Ä¢ Ground:	#2F4F4F	(dark	slate	gray) ‚Ä¢ House:	#696969	(dim	gray) ‚Ä¢ Moon:	#F0E68C	(khaki)	-	optional ‚Ä¢ Text:	#FFFFFF	(white) Layout +------------------------------------------+ |  Solar Position Visualizer               | |  [Date Picker] [Time: 10:30:45]         | +------------------------------------------+ |                                          | |              N                           | |              |                           | |         W ---
üè†--- E                     | |              |                           | |              S       
‚òÄ                  | |          (Canvas 800x600)                | |                                          | +------------------------------------------+ |  Elevation: 45.23¬∞  |  Azimuth: 135.67¬∞ | |  Sunrise: 05:48     |  Sunset: 17:29    | +------------------------------------------+ |  [
‚óÄ] [
‚è∏] [
‚ñ∂]    Speed: [1x] [10x] [60x] | |  Time: [===============|==============]   | |        00:00                       23:59  | 
--- Page 9 ---
+------------------------------------------+  Development	Milestones Milestone	1:	Backend	Foundation	(Day	1,	4	hours) Deliverables: ‚Ä¢ Flask	app	runs	on	localhost:5000 ‚Ä¢ /api/sun-position	returns	accurate	data ‚Ä¢ /api/sun-path	returns	array	of	positions ‚Ä¢ Validated	against	NOAA	calculator	(<	0.1¬∞	error) Acceptance	Criteria: ‚Ä¢ API	accessible	via	curl	or	browser ‚Ä¢ JSON	response	well-formatted ‚Ä¢ Calculations	match	reference	within	tolerance Milestone	2:	Static	Visualization	(Day	1,	4	hours) Deliverables: ‚Ä¢ Canvas	draws	house	at	center ‚Ä¢ Canvas	draws	sun	at	current	position ‚Ä¢ Canvas	draws	full	sun	path	arc ‚Ä¢ Text	displays	current	angles ‚Ä¢ Cardinal	directions	labeled Acceptance	Criteria: ‚Ä¢ Visual	matches	design	spec ‚Ä¢ Sun	position	visually	correct	(East	at	sunrise,	West	at	sunset) ‚Ä¢ All	text	readable	and	accurate Milestone	3:	Animation	(Day	2,	4	hours) 
--- Page 10 ---
Deliverables: ‚Ä¢ Play/pause	button	functional ‚Ä¢ Time	slider	updates	visualization ‚Ä¢ Sun	moves	smoothly	along	path ‚Ä¢ Time	display	updates	in	sync Acceptance	Criteria: ‚Ä¢ Animation	smooth	(‚â•30	FPS) ‚Ä¢ No	jitter	or	jumps ‚Ä¢ Controls	responsive Milestone	4:	Polish	&	Testing	(Day	2,	4	hours) Deliverables: ‚Ä¢ Speed	controls	working ‚Ä¢ Date	picker	functional ‚Ä¢ Responsive	design	(basic) ‚Ä¢ Error	handling	(no	internet,	invalid	input) ‚Ä¢ Documentation	updated Acceptance	Criteria: ‚Ä¢ All	features	work	as	specified ‚Ä¢ No	console	errors ‚Ä¢ Clean	code,	commented Testing	Requirements Unit	Tests	(Backend) def test_solar_position_accuracy():     # Compare with NOAA calculator reference values     # Test cases: sunrise, noon, sunset, midnight     # Assert error < 0.1 degrees 
--- Page 11 ---
 def test_edge_cases():     # Test midnight boundary     # Test southern hemisphere (future)     # Test extreme latitudes (future)  Manual	Tests	(Frontend) ‚Ä¢ [	]	Sun	rises	in	East	(~90¬∞	azimuth) ‚Ä¢ [	]	Sun	sets	in	West	(~270¬∞	azimuth) ‚Ä¢ [	]	Sun	highest	at	solar	noon ‚Ä¢ [	]	Night	mode	triggers	correctly ‚Ä¢ [	]	All	buttons	respond	within	100ms ‚Ä¢ [	]	Animation	smooth	at	all	speeds ‚Ä¢ [	]	Date	picker	changes	visualization Integration	Tests ‚Ä¢ [	]	API	responds	within	500ms ‚Ä¢ [	]	Frontend	handles	API	errors	gracefully ‚Ä¢ [	]	Time	sync	correct	between	backend	and	frontend Dependencies Python	(requirements.txt): flask==3.0.0 flask-cors==4.0.0 pvlib==0.10.3 pandas==2.1.3 numpy==1.26.2 pytz==2023.3  JavaScript: ‚Ä¢ None	(vanilla	JS	only) 
--- Page 12 ---
System: ‚Ä¢ Python	3.9+ ‚Ä¢ Modern	browser	with	Canvas	support Configuration config.py: # Location settings LATITUDE = 10.8231 LONGITUDE = 106.6297 ALTITUDE = 19 TIMEZONE = 'Asia/Ho_Chi_Minh'  # Visualization settings CANVAS_WIDTH = 800 CANVAS_HEIGHT = 600 SUN_PATH_RADIUS = 250 UPDATE_INTERVAL = 60  # seconds for data points  # Animation settings DEFAULT_SPEED = 1 MAX_SPEED = 300 FPS_TARGET = 30  Success	Criteria The	MVP	is	complete	when: 1. User	can	open	browser	and	see	live	sun	position 2. Animation	shows	sun	moving	across	sky	smoothly 3. All	displayed	angles	match	NOAA	calculator	within	0.1¬∞ 4. User	can	scrub	through	any	time	of	day 5. System	runs	stable	for	1+	hour	without	issues Future	Enhancements	(Not	in	MVP) 
--- Page 13 ---
‚Ä¢ Mirror	position	calculator ‚Ä¢ 3D	visualization	option ‚Ä¢ Multiple	location	support ‚Ä¢ Historical	data	playback ‚Ä¢ Export	animation	as	video ‚Ä¢ Mobile	responsive	design ‚Ä¢ Dark	mode	toggle ‚Ä¢ Multiple	language	support ‚Ä¢ Cloud	deployment Notes	for	AI	Agent ‚Ä¢ Prioritize	accuracy	of	calculations	over	UI	polish ‚Ä¢ Keep	code	simple	and	readable ‚Ä¢ Comment	all	coordinate	transformations ‚Ä¢ Use	meaningful	variable	names ‚Ä¢ Handle	edge	cases	gracefully ‚Ä¢ Log	errors	to	console	for	debugging ‚Ä¢ Make	constants	configurable ‚Ä¢ Write	modular	functions	(single	responsibility)  
